// Generated by CoffeeScript 1.7.1
(function() {
  var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  $(function() {
    var page_turner, show_page;
    show_page = function(p) {
      $('section').hide().filter(p).show();
      $('body').toggleClass('splash', p === '#splash');
      return window.scrollTo(0, 0);
    };
    page_turner = function(p) {
      return function() {
        return show_page(p);
      };
    };
    page.base('/');
    page('about', page_turner('#about'));
    page('qna', page_turner('#qna'));
    page('categories', page_turner('#categories'));
    page('agendas', function(context) {
      var c, cid, showall;
      cid = context.hash;
      $("[href=\"agendas#" + cid + "\"]").prop('disabled', true);
      c = _.find(categories, function(c) {
        return cid === JSON.stringify(c.id);
      });
      c || (c = {
        'category': 'כל האג\'נדות',
        'id': [],
        'fonticon': ''
      });
      showall = !c.id.length;
      $('#agendas h2').empty().text(c.category).prepend($("<i class=\"fa " + (c.fonticon || '') + "\"></i>"));
      $('#agendas-list li').each(function() {
        var a, aid, _ref;
        a = $(this);
        aid = a.attr('id').slice('agenda-'.length);
        return a.toggle(showall || (_ref = parseInt(aid, 10), __indexOf.call(c.id, _ref) >= 0));
      });
      return show_page('#agendas');
    });
    page('results', page_turner('#results'));
    page('', function() {
      return show_page('#splash');
    });
    page.start();
    $('#agendas-list').html(_.template($('#agenda-template').html(), {
      agendas: agendas
    }));
    return $('#agendas').on('click', 'button', function(ev) {
      var b, v;
      b = $(ev.target);
      v = (function() {
        switch (false) {
          case !b.hasClass('agree'):
            return 1;
          case !b.hasClass('indifferent'):
            return 0;
          case !b.hasClass('disagree'):
            return -1;
        }
      })();
      console.log('Voted', v, 'on', b.parent().attr('id'));
      return b.addClass('selected').siblings().removeClass('selected');
    });
  });

}).call(this);
